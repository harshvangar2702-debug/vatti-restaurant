import{r as l,A as f,j as e,o as F,s as T,u as L,t as M,B as _,R as B,d as q,e as z,f as O}from"./index-BEWonJmx.js";const U=()=>{const[r,d]=l.useState({totalReservations:0,totalMenuItems:0,totalPromotions:0,totalGalleryItems:0,totalReviews:0,approvedReviews:0,pendingReviews:0}),[k,w]=l.useState(!0);l.useEffect(()=>{x();const m=setInterval(x,1e4);return()=>clearInterval(m)},[]);const x=async()=>{try{const m=localStorage.getItem("adminToken"),h={"Content-Type":"application/json",...m&&{Authorization:`Bearer ${m}`}},[g,o,p,s,c]=await Promise.all([fetch(`${f}/api/menu`,{headers:h}),fetch(`${f}/api/reservation`,{headers:h}),fetch(`${f}/api/promotions`,{headers:h}),fetch(`${f}/api/gallery`,{headers:h}),fetch(`${f}/api/review`,{headers:h})]),v=await g.json(),u=await o.json(),N=await p.json(),a=await s.json(),n=await c.json(),i=Array.isArray(n)?n:[],y=i.filter(P=>P.approved).length,C=i.filter(P=>!P.approved).length;d({totalMenuItems:Array.isArray(v)?v.length:0,totalReservations:Array.isArray(u)?u.length:0,totalPromotions:Array.isArray(N)?N.length:0,totalGalleryItems:Array.isArray(a)?a.length:0,totalReviews:i.length,approvedReviews:y,pendingReviews:C})}catch(m){console.error("Error fetching stats:",m)}finally{w(!1)}},b=({title:m,value:h,bgColor:g="bg-blue-50",textColor:o="text-blue-600"})=>e.jsxs("div",{className:`${g} p-6 rounded-lg shadow-md border-l-4 border-orange-500`,children:[e.jsx("h3",{className:"text-gray-600 font-semibold mb-2",children:m}),e.jsx("p",{className:`text-4xl font-bold ${o}`,children:h})]});return e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold mb-8 text-gray-900",children:"Dashboard Overview"}),k?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-600",children:"Loading dashboard data..."})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-8",children:[e.jsx(b,{title:"Reservations",value:r.totalReservations,bgColor:"bg-blue-50",textColor:"text-blue-600"}),e.jsx(b,{title:"Menu Items",value:r.totalMenuItems,bgColor:"bg-green-50",textColor:"text-green-600"}),e.jsx(b,{title:"Promotions",value:r.totalPromotions,bgColor:"bg-purple-50",textColor:"text-purple-600"}),e.jsx(b,{title:"Gallery Items",value:r.totalGalleryItems,bgColor:"bg-pink-50",textColor:"text-pink-600"}),e.jsx(b,{title:"Total Reviews",value:r.totalReviews,bgColor:"bg-yellow-50",textColor:"text-yellow-600"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-4",children:"Reviews Status"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"text-gray-600 font-semibold",children:"Approved"}),e.jsx("span",{className:"text-green-600 font-bold",children:r.approvedReviews})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4",children:e.jsx("div",{className:"bg-green-500 h-4 rounded-full",style:{width:`${r.totalReviews>0?r.approvedReviews/r.totalReviews*100:0}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"text-gray-600 font-semibold",children:"Pending"}),e.jsx("span",{className:"text-yellow-600 font-bold",children:r.pendingReviews})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4",children:e.jsx("div",{className:"bg-yellow-500 h-4 rounded-full",style:{width:`${r.totalReviews>0?r.pendingReviews/r.totalReviews*100:0}%`}})})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-4",children:"Content Summary"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center p-3 bg-blue-50 rounded-lg",children:[e.jsx("span",{className:"text-gray-700",children:"Menu Items"}),e.jsx("span",{className:"text-2xl font-bold text-blue-600",children:r.totalMenuItems})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 bg-purple-50 rounded-lg",children:[e.jsx("span",{className:"text-gray-700",children:"Active Promotions"}),e.jsx("span",{className:"text-2xl font-bold text-purple-600",children:r.totalPromotions})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 bg-pink-50 rounded-lg",children:[e.jsx("span",{className:"text-gray-700",children:"Gallery Images"}),e.jsx("span",{className:"text-2xl font-bold text-pink-600",children:r.totalGalleryItems})]})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-4",children:"Quick Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4 border-l-4 border-blue-500",children:[e.jsx("p",{className:"text-gray-600 mb-2",children:"Total Bookings"}),e.jsx("p",{className:"text-4xl font-bold text-blue-600",children:r.totalReservations})]}),e.jsxs("div",{className:"text-center p-4 border-l-4 border-orange-500",children:[e.jsx("p",{className:"text-gray-600 mb-2",children:"Total Content"}),e.jsx("p",{className:"text-4xl font-bold text-orange-600",children:r.totalMenuItems+r.totalPromotions+r.totalGalleryItems})]}),e.jsxs("div",{className:"text-center p-4 border-l-4 border-green-500",children:[e.jsx("p",{className:"text-gray-600 mb-2",children:"Reviews to Approve"}),e.jsx("p",{className:"text-4xl font-bold text-green-600",children:r.pendingReviews})]})]})]})]})]})},G=()=>{const[r,d]=l.useState([]),[k,w]=l.useState(!0),[x,b]=l.useState("");l.useEffect(()=>{m();const o=setInterval(m,5e3);return()=>clearInterval(o)},[]);const m=async()=>{try{const o=localStorage.getItem("adminToken"),p={"Content-Type":"application/json",...o&&{Authorization:`Bearer ${o}`}},c=await(await fetch(`${f}/api/reservation`,{headers:p})).json();d(Array.isArray(c)?c:[])}catch(o){console.error("Error fetching reservations:",o)}finally{w(!1)}},h=async o=>{if(window.confirm("Are you sure you want to delete this reservation?"))try{const p=localStorage.getItem("adminToken");(await fetch(`${f}/api/reservation/${o}`,{method:"DELETE",headers:{Authorization:`Bearer ${p}`}})).ok&&(d(c=>c.filter(v=>v._id!==o)),alert("Reservation deleted successfully"))}catch(p){console.error("Error deleting reservation:",p),alert("Failed to delete reservation")}},g=x?r.filter(o=>o.date.startsWith(x)):r;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Reservations"}),e.jsx("button",{onClick:m,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600",children:"Refresh"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("input",{type:"date",value:x,onChange:o=>b(o.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"}),x&&e.jsx("button",{onClick:()=>b(""),className:"ml-2 px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400",children:"Clear Filter"})]}),k?e.jsx("div",{className:"text-center py-12",children:"Loading..."}):g.length===0?e.jsx("div",{className:"bg-white p-6 rounded-lg shadow text-center text-gray-500",children:"No reservations found"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full bg-white rounded-lg shadow overflow-hidden",children:[e.jsx("thead",{className:"bg-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-gray-700 font-semibold",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-gray-700 font-semibold",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left text-gray-700 font-semibold",children:"Phone"}),e.jsx("th",{className:"px-6 py-3 text-left text-gray-700 font-semibold",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-gray-700 font-semibold",children:"Time"}),e.jsx("th",{className:"px-6 py-3 text-left text-gray-700 font-semibold",children:"Party Size"}),e.jsx("th",{className:"px-6 py-3 text-left text-gray-700 font-semibold",children:"Special Requests"}),e.jsx("th",{className:"px-6 py-3 text-left text-gray-700 font-semibold",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y",children:g.map(o=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4",children:o.name}),e.jsx("td",{className:"px-6 py-4",children:o.email}),e.jsx("td",{className:"px-6 py-4",children:o.phone}),e.jsx("td",{className:"px-6 py-4",children:new Date(o.date).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4",children:o.time}),e.jsx("td",{className:"px-6 py-4",children:o.partySize}),e.jsx("td",{className:"px-6 py-4 text-sm",children:o.specialRequests||"-"}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("button",{onClick:()=>h(o._id),className:"bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm",children:"Delete"})})]},o._id))})]})})]})},J=()=>{const[r,d]=l.useState([]),[k,w]=l.useState([]),[x,b]=l.useState(!0),[m,h]=l.useState(!1),[g,o]=l.useState(!1),[p,s]=l.useState(null),[c,v]=l.useState(""),[u,N]=l.useState({name:"",description:"",price:"",image:"",category:"",dietary:[]});l.useEffect(()=>{a(),n()},[]);const a=async()=>{try{const t=localStorage.getItem("adminToken"),j={"Content-Type":"application/json",...t&&{Authorization:`Bearer ${t}`}},A=await(await fetch(`${f}/api/menu`,{headers:j})).json();d(Array.isArray(A)?A:[])}catch(t){console.error("Error fetching menu items:",t)}finally{b(!1)}},n=async()=>{try{const t=localStorage.getItem("adminToken"),j={"Content-Type":"application/json",...t&&{Authorization:`Bearer ${t}`}},S=await fetch(`${f}/api/menu/categories`,{headers:j});if(S.ok){const A=await S.json();w(Array.isArray(A)?A:[])}}catch(t){console.error("Error fetching categories:",t)}},i=async t=>{if(t.preventDefault(),!c.trim())return;const j=localStorage.getItem("adminToken");try{const S=await fetch(`${f}/api/menu/categories`,{method:"POST",headers:{"Content-Type":"application/json",...j&&{Authorization:`Bearer ${j}`}},body:JSON.stringify({name:c})});if(S.ok){const A=await S.json();w(I=>[...I,A]),v(""),o(!1),alert("Category added successfully")}else alert("Failed to add category")}catch(S){console.error("Error adding category:",S),alert("Failed to add category")}},y=async t=>{if(!window.confirm("Are you sure you want to delete this category?"))return;const j=localStorage.getItem("adminToken");try{(await fetch(`${f}/api/menu/categories/${t}`,{method:"DELETE",headers:{Authorization:`Bearer ${j}`}})).ok?(w(A=>A.filter(I=>I._id!==t)),alert("Category deleted successfully")):alert("Failed to delete category")}catch(S){console.error("Error deleting category:",S),alert("Failed to delete category")}},C=t=>{const{name:j,value:S}=t.target;N(A=>({...A,[j]:S}))},P=t=>{const{value:j,checked:S}=t.target;N(A=>({...A,dietary:S?[...A.dietary,j]:A.dietary.filter(I=>I!==j)}))},R=async t=>{t.preventDefault();const j=localStorage.getItem("adminToken");try{const S=p?"PUT":"POST",A=p?`${f}/api/menu/${p}`:`${f}/api/menu`;(await fetch(A,{method:S,headers:{"Content-Type":"application/json",...j&&{Authorization:`Bearer ${j}`}},body:JSON.stringify({...u,price:parseFloat(u.price)})})).ok&&(alert(p?"Menu item updated successfully":"Menu item created successfully"),$(),a())}catch(S){console.error("Error saving menu item:",S),alert("Failed to save menu item")}},D=t=>{N({name:t.name,description:t.description,price:t.price.toString(),image:t.image,category:typeof t.category=="string"?t.category:t.category._id,dietary:t.dietary||[]}),s(t._id),h(!0)},E=async t=>{if(window.confirm("Are you sure you want to delete this menu item?"))try{const j=localStorage.getItem("adminToken");(await fetch(`${f}/api/menu/${t}`,{method:"DELETE",headers:{Authorization:`Bearer ${j}`}})).ok&&(d(A=>A.filter(I=>I._id!==t)),alert("Menu item deleted successfully"))}catch(j){console.error("Error deleting menu item:",j),alert("Failed to delete menu item")}},$=()=>{N({name:"",description:"",price:"",image:"",category:"",dietary:[]}),s(null),h(!1)};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Menu Management"}),e.jsx("button",{onClick:()=>h(!m),className:"bg-orange-500 hover:bg-orange-600 text-white px-6 py-2 rounded-lg",children:m?"Cancel":"Add Menu Item"})]}),e.jsxs("div",{className:"bg-blue-50 p-6 rounded-lg shadow mb-6 border border-blue-200",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Categories"}),e.jsx("button",{onClick:()=>o(!g),className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm",children:g?"Cancel":"Add Category"})]}),g&&e.jsxs("form",{onSubmit:i,className:"mb-4 flex gap-2",children:[e.jsx("input",{type:"text",value:c,onChange:t=>v(t.target.value),placeholder:"Enter category name",required:!0,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("button",{type:"submit",className:"bg-green-500 hover:bg-green-600 text-white px-6 py-2 rounded-lg",children:"Add"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:k.map(t=>e.jsxs("div",{className:"bg-white px-4 py-2 rounded-lg border border-blue-300 flex items-center gap-2 shadow-sm",children:[e.jsx("span",{className:"text-gray-700 font-medium",children:t.name}),e.jsx("button",{onClick:()=>y(t._id),className:"text-red-500 hover:text-red-700 font-bold ml-2",children:"âœ•"})]},t._id))}),k.length===0&&!g&&e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No categories yet. Add one to get started!"})]}),m&&e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:p?"Edit Menu Item":"Add New Menu Item"}),e.jsxs("form",{onSubmit:R,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Name"}),e.jsx("input",{type:"text",name:"name",value:u.name,onChange:C,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Price"}),e.jsx("input",{type:"number",name:"price",value:u.price,onChange:C,step:"0.01",required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Description"}),e.jsx("textarea",{name:"description",value:u.description,onChange:C,required:!0,rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Category"}),e.jsxs("select",{name:"category",value:u.category,onChange:C,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"",children:"Select Category"}),k.map(t=>e.jsx("option",{value:t._id,children:t.name},t._id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Image URL"}),e.jsx("input",{type:"text",name:"image",value:u.image,onChange:C,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Dietary Options"}),e.jsx("div",{className:"space-y-2",children:["Vegan","Vegetarian","Gluten-Free","Dairy-Free"].map(t=>e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",value:t,checked:u.dietary.includes(t),onChange:P,className:"w-4 h-4 text-orange-500 rounded focus:ring-2 focus:ring-orange-500"}),e.jsx("span",{className:"ml-2 text-gray-700",children:t})]},t))})]}),e.jsx("button",{type:"submit",className:"bg-green-500 hover:bg-green-600 text-white px-6 py-2 rounded-lg",children:p?"Update Item":"Add Item"})]})]}),x?e.jsx("div",{className:"text-center py-12",children:"Loading..."}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(t=>e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden hover:shadow-lg transition",children:[t.image&&e.jsx("img",{src:t.image,alt:t.name,className:"w-full h-40 object-cover"}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:t.name}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[t.description.substring(0,50),"..."]}),e.jsxs("p",{className:"text-orange-500 font-bold mt-2",children:["â‚¹",t.price]}),t.dietary&&t.dietary.length>0&&e.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:t.dietary.map(j=>e.jsx("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-1 rounded",children:j},j))}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsx("button",{onClick:()=>D(t),className:"flex-1 bg-blue-500 hover:bg-blue-600 text-white py-2 rounded text-sm",children:"Edit"}),e.jsx("button",{onClick:()=>E(t._id),className:"flex-1 bg-red-500 hover:bg-red-600 text-white py-2 rounded text-sm",children:"Delete"})]})]})]},t._id))})]})},V=()=>{const[r,d]=l.useState([]),[k,w]=l.useState(!0),[x,b]=l.useState(!1),[m,h]=l.useState(null),[g,o]=l.useState({title:"",description:"",discount:"",code:"",expiryDate:"",image:""});l.useEffect(()=>{p()},[]);const p=async()=>{try{const a=localStorage.getItem("adminToken"),n={"Content-Type":"application/json",...a&&{Authorization:`Bearer ${a}`}},y=await(await fetch(`${f}/api/promotions`,{headers:n})).json();d(Array.isArray(y)?y:[])}catch(a){console.error("Error fetching promotions:",a)}finally{w(!1)}},s=a=>{const{name:n,value:i}=a.target;o(y=>({...y,[n]:i}))},c=async a=>{a.preventDefault();const n=localStorage.getItem("adminToken");try{const i=m?"PUT":"POST",y=m?`${f}/api/promotions/${m}`:`${f}/api/promotions`,C=await fetch(y,{method:i,headers:{"Content-Type":"application/json",...n&&{Authorization:`Bearer ${n}`}},body:JSON.stringify({...g,discount:parseFloat(g.discount)})});if(C.ok)alert(m?"Promotion updated successfully":"Promotion created successfully"),N(),p();else{const P=await C.json();alert(`Error: ${P.message||"Failed to save promotion"}`)}}catch(i){console.error("Error saving promotion:",i),alert("Failed to save promotion. Please check the console for details.")}},v=a=>{o({title:a.title,description:a.description,discount:a.discount.toString(),code:a.code,expiryDate:a.expiryDate.split("T")[0],image:a.image}),h(a._id),b(!0)},u=async a=>{if(window.confirm("Are you sure you want to delete this promotion?"))try{const n=localStorage.getItem("adminToken");(await fetch(`${f}/api/promotions/${a}`,{method:"DELETE",headers:{Authorization:`Bearer ${n}`}})).ok&&(d(y=>y.filter(C=>C._id!==a)),alert("Promotion deleted successfully"))}catch(n){console.error("Error deleting promotion:",n),alert("Failed to delete promotion")}},N=()=>{o({title:"",description:"",discount:"",code:"",expiryDate:"",image:""}),h(null),b(!1)};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Promotions Management"}),e.jsx("button",{onClick:()=>b(!x),className:"bg-orange-500 hover:bg-orange-600 text-white px-6 py-2 rounded-lg",children:x?"Cancel":"Add Promotion"})]}),x&&e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:m?"Edit Promotion":"Add New Promotion"}),e.jsxs("form",{onSubmit:c,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Title"}),e.jsx("input",{type:"text",name:"title",value:g.title,onChange:s,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Discount (%)"}),e.jsx("input",{type:"number",name:"discount",value:g.discount,onChange:s,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Description"}),e.jsx("textarea",{name:"description",value:g.description,onChange:s,required:!0,rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Promo Code"}),e.jsx("input",{type:"text",name:"code",value:g.code,onChange:s,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Expiry Date"}),e.jsx("input",{type:"date",name:"expiryDate",value:g.expiryDate,onChange:s,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Image URL"}),e.jsx("input",{type:"text",name:"image",value:g.image,onChange:s,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]})]}),e.jsx("button",{type:"submit",className:"bg-green-500 hover:bg-green-600 text-white px-6 py-2 rounded-lg",children:m?"Update Promotion":"Add Promotion"})]})]}),k?e.jsx("div",{className:"text-center py-12",children:"Loading..."}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:r.map(a=>e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden hover:shadow-lg transition",children:[a.image&&e.jsx("img",{src:a.image,alt:a.title,className:"w-full h-40 object-cover"}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:a.title}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:a.description}),e.jsxs("div",{className:"mt-3 flex justify-between items-center",children:[e.jsxs("span",{className:"text-2xl font-bold text-orange-500",children:[a.discount,"%"]}),e.jsx("span",{className:"bg-orange-100 text-orange-700 px-3 py-1 rounded text-sm font-semibold",children:a.code})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Expires: ",new Date(a.expiryDate).toLocaleDateString()]}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsx("button",{onClick:()=>v(a),className:"flex-1 bg-blue-500 hover:bg-blue-600 text-white py-2 rounded text-sm",children:"Edit"}),e.jsx("button",{onClick:()=>u(a._id),className:"flex-1 bg-red-500 hover:bg-red-600 text-white py-2 rounded text-sm",children:"Delete"})]})]})]},a._id))})]})},Q=()=>{const[r,d]=l.useState([]),[k,w]=l.useState(!0),[x,b]=l.useState("all");l.useEffect(()=>{m()},[]);const m=async()=>{try{const s=localStorage.getItem("adminToken"),c={"Content-Type":"application/json",...s&&{Authorization:`Bearer ${s}`}},u=await(await fetch(`${f}/api/review`,{headers:c})).json();d(Array.isArray(u)?u:[])}catch(s){console.error("Error fetching reviews:",s)}finally{w(!1)}},h=async s=>{try{const c=localStorage.getItem("adminToken");(await fetch(`${f}/api/review/${s}`,{method:"PUT",headers:{"Content-Type":"application/json",...c&&{Authorization:`Bearer ${c}`}},body:JSON.stringify({approved:!0})})).ok&&(d(u=>u.map(N=>N._id===s?{...N,approved:!0}:N)),alert("Review approved successfully"))}catch(c){console.error("Error approving review:",c),alert("Failed to approve review")}},g=async s=>{try{const c=localStorage.getItem("adminToken");(await fetch(`${f}/api/review/${s}`,{method:"DELETE",headers:{Authorization:`Bearer ${c}`}})).ok&&(d(u=>u.filter(N=>N._id!==s)),alert("Review deleted successfully"))}catch(c){console.error("Error deleting review:",c),alert("Failed to delete review")}},o=r.filter(s=>x==="approved"?s.approved:x==="pending"?!s.approved:!0),p=s=>"â­".repeat(s);return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Reviews Management"}),e.jsx("div",{className:"flex gap-2",children:["all","approved","pending"].map(s=>e.jsx("button",{onClick:()=>b(s),className:`px-4 py-2 rounded-lg ${x===s?"bg-orange-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:s.charAt(0).toUpperCase()+s.slice(1)},s))})]}),k?e.jsx("div",{className:"text-center py-12",children:"Loading..."}):o.length===0?e.jsx("div",{className:"bg-white p-6 rounded-lg shadow text-center text-gray-500",children:"No reviews found"}):e.jsx("div",{className:"space-y-4",children:o.map(s=>e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow hover:shadow-lg transition",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600",children:s.email})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xl",children:p(s.rating)}),e.jsx("span",{className:`inline-block px-3 py-1 rounded text-sm font-semibold ${s.approved?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:s.approved?"Approved":"Pending"})]})]}),e.jsx("p",{className:"text-gray-700 mb-3",children:s.comment}),e.jsxs("p",{className:"text-xs text-gray-400 mb-4",children:[new Date(s.createdAt).toLocaleDateString()," ",new Date(s.createdAt).toLocaleTimeString()]}),e.jsxs("div",{className:"flex gap-2",children:[!s.approved&&e.jsx("button",{onClick:()=>h(s._id),className:"flex-1 bg-green-500 hover:bg-green-600 text-white py-2 rounded text-sm",children:"Approve"}),e.jsx("button",{onClick:()=>g(s._id),className:"flex-1 bg-red-500 hover:bg-red-600 text-white py-2 rounded text-sm",children:s.approved?"Delete":"Reject"})]})]},s._id))})]})},W=F({currentPassword:T().min(1,"Current password is required"),newPassword:T().min(8,"New password must be at least 8 characters"),confirmPassword:T().min(1,"Please confirm your password")}).refine(r=>r.newPassword===r.confirmPassword,{message:"Passwords do not match",path:["confirmPassword"]});function H(){const[r,d]=l.useState(!1),[k,w]=l.useState(null),[x,b]=l.useState(!1),m=localStorage.getItem("adminName")||"Admin",h=localStorage.getItem("adminEmail")||"admin@vatti.com",{register:g,handleSubmit:o,reset:p,formState:{errors:s}}=L({resolver:M(W)}),c=async v=>{try{d(!0),w(null);const u=await fetch(`${f}/api/auth/change-password`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("adminToken")}`},body:JSON.stringify({email:h,currentPassword:v.currentPassword,newPassword:v.newPassword})});if(!u.ok){const N=await u.json();throw new Error(N.message||"Failed to change password")}w({type:"success",text:"Password changed successfully! Please log in with your new password."}),p(),setTimeout(()=>{localStorage.removeItem("adminToken"),localStorage.removeItem("adminName"),localStorage.removeItem("adminEmail"),window.location.href="/admin.html"},2e3)}catch(u){w({type:"error",text:u instanceof Error?u.message:"Failed to change password"})}finally{d(!1)}};return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Account Settings"}),e.jsx("p",{className:"text-gray-600",children:"Manage your admin account"})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-6 mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Admin Information"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Admin Name"}),e.jsx("p",{className:"text-gray-800 font-medium",children:m})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Email Address"}),e.jsx("p",{className:"text-gray-800 font-medium",children:h})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-6",children:"Change Password"}),k&&e.jsx("div",{className:`mb-6 p-4 rounded-lg ${k.type==="success"?"bg-green-100 text-green-700 border border-green-300":"bg-red-100 text-red-700 border border-red-300"}`,children:k.text}),e.jsxs("form",{onSubmit:o(c),className:"space-y-6 max-w-md",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"currentPassword",className:"block text-sm font-medium text-gray-700 mb-2",children:"Current Password"}),e.jsx("div",{className:"relative",children:e.jsx("input",{...g("currentPassword"),type:x?"text":"password",placeholder:"Enter your current password",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})}),s.currentPassword&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:s.currentPassword.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-700 mb-2",children:"New Password"}),e.jsx("input",{...g("newPassword"),type:x?"text":"password",placeholder:"Enter your new password",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"}),s.newPassword&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:s.newPassword.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm New Password"}),e.jsx("input",{...g("confirmPassword"),type:x?"text":"password",placeholder:"Confirm your new password",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"}),s.confirmPassword&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:s.confirmPassword.message})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-700",children:[e.jsx("input",{type:"checkbox",checked:x,onChange:v=>b(v.target.checked),className:"w-4 h-4 cursor-pointer"}),"Show passwords"]}),e.jsx("button",{type:"submit",disabled:r,className:"w-full bg-orange-500 hover:bg-orange-600 disabled:bg-gray-400 text-white font-bold py-3 rounded-lg transition-colors duration-200",children:r?"Changing Password...":"Change Password"})]}),e.jsx("p",{className:"text-gray-500 text-sm mt-6",children:"â„¹ï¸ After changing your password, you will be logged out and need to log in with your new credentials."})]})]})}const K=({onLogin:r})=>{const[d,k]=l.useState({email:"",password:""}),[w,x]=l.useState(""),[b,m]=l.useState(!1),[h,g]=l.useState(!1),[o,p]=l.useState(""),[s,c]=l.useState(null),v=a=>{const{name:n,value:i}=a.target;k(y=>({...y,[n]:i}))},u=async a=>{var n;a.preventDefault(),x(""),m(!0);try{const i=await fetch(`${f}/api/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)}),y=await i.json();if(!i.ok)throw new Error(y.message||"Invalid email or password");if(!y.token)throw new Error("No token received from server");const C=((n=y.user)==null?void 0:n.name)||y.name||d.email;localStorage.setItem("adminEmail",d.email),r(y.token,C)}catch(i){i instanceof TypeError?x(`Cannot connect to server. Make sure backend is running on ${f}`):x(i instanceof Error?i.message:"Login failed")}finally{m(!1)}},N=async a=>{if(a.preventDefault(),c(null),!o.trim()){c({type:"error",text:"Please enter your email address"});return}try{const n=await fetch(`${f}/api/auth/forgot-password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:o})}),i=await n.json();if(!n.ok)throw new Error(i.message||"Failed to send reset email");c({type:"success",text:"If an account exists with this email, a password reset link has been sent. Please check your email."}),p("")}catch(n){c({type:"error",text:n instanceof Error?n.message:"Failed to process forgot password request"})}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:e.jsxs("div",{className:"bg-white p-12 rounded-lg shadow-2xl w-full max-w-md",children:[e.jsx("h1",{className:"text-4xl font-bold mb-8 text-center text-gray-900",children:h?"Reset Password":"Admin Login"}),h?e.jsxs(e.Fragment,{children:[s&&e.jsx("div",{className:`mb-4 p-3 rounded text-sm ${s.type==="success"?"bg-green-100 border border-green-400 text-green-700":"bg-red-100 border border-red-400 text-red-700"}`,children:s.text}),e.jsxs("form",{onSubmit:N,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-lg font-medium text-gray-700 mb-2",children:"Email Address"}),e.jsx("input",{type:"email",value:o,onChange:a=>p(a.target.value),required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500",placeholder:"admin@restaurant.com"})]}),e.jsx("button",{type:"submit",className:"w-full bg-orange-500 hover:bg-orange-600 text-white font-bold py-3 rounded-lg transition duration-300",children:"Send Reset Link"})]}),e.jsx("button",{onClick:()=>g(!1),className:"w-full mt-4 text-orange-500 hover:text-orange-600 font-medium py-2",children:"Back to Login"})]}):e.jsxs(e.Fragment,{children:[w&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:w}),e.jsxs("form",{onSubmit:u,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-lg font-medium text-gray-700 mb-2",children:"Email"}),e.jsx("input",{type:"email",name:"email",value:d.email,onChange:v,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500",placeholder:"admin@restaurant.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-lg font-medium text-gray-700 mb-2",children:"Password"}),e.jsx("input",{type:"password",name:"password",value:d.password,onChange:v,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"})]}),e.jsx("button",{type:"submit",disabled:b,className:"w-full bg-orange-500 hover:bg-orange-600 disabled:bg-gray-400 text-white font-bold py-3 rounded-lg transition duration-300",children:b?"Logging in...":"Login"})]}),e.jsx("button",{onClick:()=>g(!0),className:"w-full mt-4 text-orange-500 hover:text-orange-600 font-medium py-2",children:"Forgot Password?"})]})]})})},X=()=>{const[r,d]=l.useState("login"),[k,w]=l.useState(!1),[x,b]=l.useState(""),[m,h]=l.useState([]),[g,o]=l.useState(0),[p,s]=l.useState([]);l.useEffect(()=>{const n=localStorage.getItem("adminToken"),i=localStorage.getItem("adminName");if(n&&i){w(!0),b(i),d("dashboard"),"Notification"in window&&Notification.permission==="default"&&Notification.requestPermission(),c(n);const y=setInterval(()=>c(n),1e4);return()=>clearInterval(y)}},[]);const c=async n=>{try{const i={"Content-Type":"application/json",Authorization:`Bearer ${n}`},C=await(await fetch(`${f}/api/reservation`,{headers:i})).json(),P=Array.isArray(C)?C:[],R=P.map(E=>E._id);R.filter(E=>!p.includes(E)).forEach(E=>{const $=P.find(t=>t._id===E);if($){const t=`New Reservation from ${$.name} for ${$.partySize} people on ${new Date($.date).toLocaleDateString()}`;v(t,"success"),"Notification"in window&&Notification.permission==="granted"&&new Notification("ðŸ”” New Restaurant Reservation",{body:t,icon:"ðŸ½ï¸",tag:"reservation-"+E,requireInteraction:!0})}}),s(R),o(P.length)}catch(i){console.error("Error checking reservations:",i)}},v=(n,i="info")=>{const y=Math.random().toString(36).substr(2,9),C={id:y,message:n,type:i,timestamp:new Date};h(P=>[...P,C]),setTimeout(()=>{h(P=>P.filter(R=>R.id!==y))},5e3)},u=(n,i)=>{localStorage.setItem("adminToken",n),localStorage.setItem("adminName",i),w(!0),b(i),d("dashboard")},N=()=>{localStorage.removeItem("adminToken"),localStorage.removeItem("adminName"),localStorage.removeItem("adminEmail"),w(!1),b(""),d("login")};if(!k)return e.jsx(K,{onLogin:u});const a=n=>{switch(n){case"success":return"bg-green-500";case"error":return"bg-red-500";case"warning":return"bg-yellow-500";default:return"bg-blue-500"}};return e.jsxs("div",{className:"flex h-screen bg-gray-100",children:[e.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:m.map(n=>e.jsx("div",{className:`${a(n.type)} text-white px-6 py-3 rounded-lg shadow-lg animate-pulse`,children:e.jsxs("div",{className:"font-semibold flex items-center",children:[e.jsx("span",{className:"mr-2",children:"ðŸ””"}),n.message]})},n.id))}),e.jsxs("div",{className:"w-64 bg-gray-900 text-white p-6 overflow-y-auto",children:[e.jsx("h1",{className:"text-2xl font-bold mb-8",children:"Vatti Admin"}),e.jsxs("nav",{className:"space-y-4",children:[e.jsx("button",{onClick:()=>d("dashboard"),className:`w-full text-left px-4 py-2 rounded ${r==="dashboard"?"bg-orange-500":"hover:bg-gray-800"}`,children:"Dashboard"}),e.jsx("button",{onClick:()=>d("reservations"),className:`w-full text-left px-4 py-2 rounded ${r==="reservations"?"bg-orange-500":"hover:bg-gray-800"}`,children:"Reservations"}),e.jsx("button",{onClick:()=>d("menu"),className:`w-full text-left px-4 py-2 rounded ${r==="menu"?"bg-orange-500":"hover:bg-gray-800"}`,children:"Menu"}),e.jsx("button",{onClick:()=>d("promotions"),className:`w-full text-left px-4 py-2 rounded ${r==="promotions"?"bg-orange-500":"hover:bg-gray-800"}`,children:"Promotions"}),e.jsx("button",{onClick:()=>d("reviews"),className:`w-full text-left px-4 py-2 rounded ${r==="reviews"?"bg-orange-500":"hover:bg-gray-800"}`,children:"Reviews"})]}),e.jsxs("div",{className:"mt-8 pt-8 border-t border-gray-700",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Logged in as:"}),e.jsx("p",{className:"text-white font-semibold mb-4",children:x}),e.jsx("button",{onClick:()=>d("settings"),className:"w-full bg-gray-700 hover:bg-gray-600 text-white py-2 rounded mb-2",children:"Settings"}),e.jsx("button",{onClick:N,className:"w-full bg-red-600 hover:bg-red-700 text-white py-2 rounded",children:"Logout"})]})]}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsxs("div",{className:"p-8",children:[r==="dashboard"&&e.jsx(U,{}),r==="reservations"&&e.jsx(G,{}),r==="menu"&&e.jsx(J,{}),r==="promotions"&&e.jsx(V,{}),r==="reviews"&&e.jsx(Q,{}),r==="settings"&&e.jsx(H,{})]})})]})};function Y(){return e.jsx(_,{children:e.jsx(B,{children:e.jsx(q,{path:"*",element:e.jsx(X,{})})})})}z.createRoot(document.getElementById("root")).render(e.jsx(O.StrictMode,{children:e.jsx(Y,{})}));
